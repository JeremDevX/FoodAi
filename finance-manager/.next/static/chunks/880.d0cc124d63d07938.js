"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[880],{10880:function(t,e,n){n.d(e,{CP:function(){return d},M6:function(){return y},T8:function(){return g},addGoal:function(){return p},addTransaction:function(){return c},db:function(){return r},deleteTransaction:function(){return l},exportData:function(){return w},f1:function(){return s},getSettings:function(){return D},importData:function(){return b},initializeDatabase:function(){return i},updateGoal:function(){return f},updateSettings:function(){return m},updateTransaction:function(){return u}});var a=n(42179);class o extends a.ZP{constructor(){super("FinanceManager"),this.version(1).stores({transactions:"++id, date, amount, category, account, type",categories:"++id, name, type, parentId",goals:"++id, name, targetAmount, currentAmount, deadline",accounts:"++id, name, type, balance, currency, isActive",budgets:"++id, categoryId, amount, period, startDate",settings:"++id"})}}let r=new o;async function i(){try{if(!window.indexedDB){console.warn("IndexedDB not available in this environment");return}let t=await r.categories.count();0===t&&await r.categories.bulkAdd([{name:"Alimentation",color:"#10b981",icon:"\uD83C\uDF4E",type:"expense"},{name:"Transport",color:"#3b82f6",icon:"\uD83D\uDE97",type:"expense"},{name:"Logement",color:"#8b5cf6",icon:"\uD83C\uDFE0",type:"expense"},{name:"Sant\xe9",color:"#ef4444",icon:"\uD83C\uDFE5",type:"expense"},{name:"Loisirs",color:"#f59e0b",icon:"\uD83C\uDFAE",type:"expense"},{name:"Shopping",color:"#ec4899",icon:"\uD83D\uDECD️",type:"expense"},{name:"Restaurant",color:"#f97316",icon:"\uD83C\uDF7D️",type:"expense"},{name:"Services",color:"#6b7280",icon:"⚡",type:"expense"},{name:"Salaire",color:"#10b981",icon:"\uD83D\uDCB0",type:"income"},{name:"Investissement",color:"#6366f1",icon:"\uD83D\uDCC8",type:"income"},{name:"Cadeau",color:"#f59e0b",icon:"\uD83C\uDF81",type:"income"},{name:"Autre",color:"#6b7280",icon:"\uD83D\uDCDD",type:"both"}]);let e=await r.accounts.count();0===e&&await r.accounts.add({name:"Compte Principal",type:"checking",balance:0,currency:"EUR",color:"#3b82f6",isActive:!0});let n=await r.settings.count();0===n&&await r.settings.add({currency:"EUR",language:"fr",theme:"system",dateFormat:"dd/MM/yyyy",weekStartsOn:"monday",notifications:!0,autoBackup:!0}),console.log("Database initialized successfully")}catch(t){console.error("Error initializing database:",t),console.warn("Database initialization failed, app will run with limited functionality")}}async function c(t){return await r.transactions.add({...t,createdAt:new Date,updatedAt:new Date})}async function s(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return await r.transactions.orderBy("date").reverse().offset(e).limit(t).toArray()}async function u(t,e){return await r.transactions.update(t,{...e,updatedAt:new Date})}async function l(t){return await r.transactions.delete(t)}async function d(){return await r.categories.toArray()}async function y(){return await r.goals.toArray()}async function p(t){return await r.goals.add({...t,createdAt:new Date,updatedAt:new Date})}async function f(t,e){return await r.goals.update(t,{...e,updatedAt:new Date})}async function g(){return await r.accounts.toArray()}async function D(){return(await r.settings.toArray())[0]||null}async function m(t){let e=await D();if(null==e?void 0:e.id)return await r.settings.update(e.id,t)}async function w(){let[t,e,n,a,o,i]=await Promise.all([r.transactions.toArray(),r.categories.toArray(),r.goals.toArray(),r.accounts.toArray(),r.budgets.toArray(),r.settings.toArray()]);return{version:"1.0.0",exportedAt:new Date,transactions:t,categories:e,goals:n,accounts:a,budgets:o,settings:i[0]||null}}async function b(t){await Promise.all([r.transactions.clear(),r.categories.clear(),r.goals.clear(),r.accounts.clear(),r.budgets.clear(),r.settings.clear()]),await Promise.all([r.transactions.bulkAdd(t.transactions||[]),r.categories.bulkAdd(t.categories||[]),r.goals.bulkAdd(t.goals||[]),r.accounts.bulkAdd(t.accounts||[]),r.budgets.bulkAdd(t.budgets||[]),t.settings?r.settings.add(t.settings):Promise.resolve()])}}}]);